transaction_safe_dynamic